\hypertarget{_kernel_bp_stereo_8cu}{}\doxysection{src/beliefprop/\+Bp\+Optimize\+CUDA/\+Kernel\+Bp\+Stereo.cu File Reference}
\label{_kernel_bp_stereo_8cu}\index{src/beliefprop/BpOptimizeCUDA/KernelBpStereo.cu@{src/beliefprop/BpOptimizeCUDA/KernelBpStereo.cu}}


This file defines the methods to perform belief propagation for disparity map estimation from stereo images on CUDA.  


{\ttfamily \#include \char`\"{}Bp\+Shared\+Functs/\+Shared\+Bp\+Processing\+Functs.\+h\char`\"{}}\newline
Include dependency graph for Kernel\+Bp\+Stereo.\+cu\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{_kernel_bp_stereo_8cu__incl}
\end{center}
\end{figure}
This graph shows which files directly or indirectly include this file\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=227pt]{_kernel_bp_stereo_8cu__dep__incl}
\end{center}
\end{figure}
\doxysubsection*{Namespaces}
\begin{DoxyCompactItemize}
\item 
 \mbox{\hyperlink{namespacebeliefprop__cuda}{beliefprop\+\_\+cuda}}
\begin{DoxyCompactList}\small\item\em Namespace to define global kernel functions for parallel belief propagation processing using CUDA. \end{DoxyCompactList}\end{DoxyCompactItemize}
\doxysubsection*{Functions}
\begin{DoxyCompactItemize}
\item 
{\footnotesize template$<$Run\+Data\+\_\+t T, unsigned int DISP\+\_\+\+VALS$>$ }\\\+\_\+\+\_\+global\+\_\+\+\_\+ void \mbox{\hyperlink{namespacebeliefprop__cuda_aa26f576e04e40f0a4f907772433d4ae0}{beliefprop\+\_\+cuda\+::\+Initialize\+Bottom\+Level\+Data}} (\mbox{\hyperlink{structbeliefprop_1_1_bp_level_properties}{beliefprop\+::\+Bp\+Level\+Properties}} current\+\_\+bp\+\_\+level, float $\ast$image\+\_\+1\+\_\+pixels\+\_\+device, float $\ast$image\+\_\+2\+\_\+pixels\+\_\+device, T $\ast$data\+\_\+cost\+\_\+stereo\+\_\+checkerboard\+\_\+0, T $\ast$data\+\_\+cost\+\_\+stereo\+\_\+checkerboard\+\_\+1, float lambda\+\_\+bp, float data\+\_\+k\+\_\+bp, unsigned int bp\+\_\+settings\+\_\+disp\+\_\+vals)
\begin{DoxyCompactList}\small\item\em Initialize the \char`\"{}data cost\char`\"{} for each possible disparity between the two full-\/sized input images (\char`\"{}bottom\char`\"{} of the image pyramid). The image data is stored in the image\+\_\+1\+\_\+pixels\+\_\+device and image\+\_\+2\+\_\+pixels\+\_\+device arrays. \end{DoxyCompactList}\item 
{\footnotesize template$<$Run\+Data\+\_\+t T, unsigned int DISP\+\_\+\+VALS$>$ }\\\+\_\+\+\_\+global\+\_\+\+\_\+ void \mbox{\hyperlink{namespacebeliefprop__cuda_aad53fa3d6b6ffbd594170ca738f41515}{beliefprop\+\_\+cuda\+::\+Initialize\+Current\+Level\+Data}} (\mbox{\hyperlink{namespacebeliefprop_a85dcfe709b354b19752ea8ae432f5af5}{beliefprop\+::\+Checkerboard\+Part}} checkerboard\+\_\+part, \mbox{\hyperlink{structbeliefprop_1_1_bp_level_properties}{beliefprop\+::\+Bp\+Level\+Properties}} current\+\_\+bp\+\_\+level, \mbox{\hyperlink{structbeliefprop_1_1_bp_level_properties}{beliefprop\+::\+Bp\+Level\+Properties}} prev\+\_\+bp\+\_\+level, T $\ast$data\+\_\+cost\+\_\+checkerboard\+\_\+0, T $\ast$data\+\_\+cost\+\_\+checkerboard\+\_\+1, T $\ast$data\+\_\+cost\+\_\+current\+\_\+level, unsigned int offset\+\_\+num, unsigned int bp\+\_\+settings\+\_\+disp\+\_\+vals)
\begin{DoxyCompactList}\small\item\em Initialize the data costs at the \char`\"{}next\char`\"{} level up in the pyramid given that the data at the lower has been set. \end{DoxyCompactList}\item 
{\footnotesize template$<$Run\+Data\+\_\+t T, unsigned int DISP\+\_\+\+VALS$>$ }\\\+\_\+\+\_\+global\+\_\+\+\_\+ void \mbox{\hyperlink{namespacebeliefprop__cuda_a319e93b6f471e7c43afbff1c9506882f}{beliefprop\+\_\+cuda\+::\+Initialize\+Message\+Vals\+To\+Default\+Kernel}} (\mbox{\hyperlink{structbeliefprop_1_1_bp_level_properties}{beliefprop\+::\+Bp\+Level\+Properties}} current\+\_\+bp\+\_\+level, T $\ast$message\+\_\+u\+\_\+checkerboard\+\_\+0, T $\ast$message\+\_\+d\+\_\+checkerboard\+\_\+0, T $\ast$message\+\_\+l\+\_\+checkerboard\+\_\+0, T $\ast$message\+\_\+r\+\_\+checkerboard\+\_\+0, T $\ast$message\+\_\+u\+\_\+checkerboard\+\_\+1, T $\ast$message\+\_\+d\+\_\+checkerboard\+\_\+1, T $\ast$message\+\_\+l\+\_\+checkerboard\+\_\+1, T $\ast$message\+\_\+r\+\_\+checkerboard\+\_\+1, unsigned int bp\+\_\+settings\+\_\+disp\+\_\+vals)
\begin{DoxyCompactList}\small\item\em Initialize the message values at each pixel of the current level to the default value. \end{DoxyCompactList}\item 
{\footnotesize template$<$Run\+Data\+\_\+t T, unsigned int DISP\+\_\+\+VALS$>$ }\\\+\_\+\+\_\+global\+\_\+\+\_\+ void \mbox{\hyperlink{namespacebeliefprop__cuda_a316a4698e007f4722b4cc9bc4015c692}{beliefprop\+\_\+cuda\+::\+Run\+BPIteration\+Using\+Checkerboard\+Updates}} (\mbox{\hyperlink{namespacebeliefprop_a85dcfe709b354b19752ea8ae432f5af5}{beliefprop\+::\+Checkerboard\+Part}} checkerboard\+\_\+to\+\_\+update, \mbox{\hyperlink{structbeliefprop_1_1_bp_level_properties}{beliefprop\+::\+Bp\+Level\+Properties}} current\+\_\+bp\+\_\+level, T $\ast$data\+\_\+cost\+\_\+checkerboard\+\_\+0, T $\ast$data\+\_\+cost\+\_\+checkerboard\+\_\+1, T $\ast$message\+\_\+u\+\_\+checkerboard\+\_\+0, T $\ast$message\+\_\+d\+\_\+checkerboard\+\_\+0, T $\ast$message\+\_\+l\+\_\+checkerboard\+\_\+0, T $\ast$message\+\_\+r\+\_\+checkerboard\+\_\+0, T $\ast$message\+\_\+u\+\_\+checkerboard\+\_\+1, T $\ast$message\+\_\+d\+\_\+checkerboard\+\_\+1, T $\ast$message\+\_\+l\+\_\+checkerboard\+\_\+1, T $\ast$message\+\_\+r\+\_\+checkerboard\+\_\+1, float disc\+\_\+k\+\_\+bp, bool data\+\_\+aligned, unsigned int bp\+\_\+settings\+\_\+disp\+\_\+vals)
\begin{DoxyCompactList}\small\item\em Kernel function to run the current iteration of belief propagation in parallel using the checkerboard update method where half the pixels in the \char`\"{}checkerboard\char`\"{} scheme retrieve messages from each 4-\/connected neighbor and then update their message based on the retrieved messages and the data cost. \end{DoxyCompactList}\item 
{\footnotesize template$<$Run\+Data\+\_\+t T, unsigned int DISP\+\_\+\+VALS$>$ }\\\+\_\+\+\_\+global\+\_\+\+\_\+ void \mbox{\hyperlink{namespacebeliefprop__cuda_ae991742366ec63db54f1a4ec8c6c911c}{beliefprop\+\_\+cuda\+::\+Run\+BPIteration\+Using\+Checkerboard\+Updates}} (\mbox{\hyperlink{namespacebeliefprop_a85dcfe709b354b19752ea8ae432f5af5}{beliefprop\+::\+Checkerboard\+Part}} checkerboard\+\_\+to\+\_\+update, \mbox{\hyperlink{structbeliefprop_1_1_bp_level_properties}{beliefprop\+::\+Bp\+Level\+Properties}} current\+\_\+bp\+\_\+level, T $\ast$data\+\_\+cost\+\_\+checkerboard\+\_\+0, T $\ast$data\+\_\+cost\+\_\+checkerboard\+\_\+1, T $\ast$message\+\_\+u\+\_\+checkerboard\+\_\+0, T $\ast$message\+\_\+d\+\_\+checkerboard\+\_\+0, T $\ast$message\+\_\+l\+\_\+checkerboard\+\_\+0, T $\ast$message\+\_\+r\+\_\+checkerboard\+\_\+0, T $\ast$message\+\_\+u\+\_\+checkerboard\+\_\+1, T $\ast$message\+\_\+d\+\_\+checkerboard\+\_\+1, T $\ast$message\+\_\+l\+\_\+checkerboard\+\_\+1, T $\ast$message\+\_\+r\+\_\+checkerboard\+\_\+1, float disc\+\_\+k\+\_\+bp, bool data\+\_\+aligned, unsigned int bp\+\_\+settings\+\_\+disp\+\_\+vals, void $\ast$dst\+\_\+processing)
\begin{DoxyCompactList}\small\item\em Kernel function to run the current iteration of belief propagation in parallel using the checkerboard update method where half the pixels in the \char`\"{}checkerboard\char`\"{} scheme retrieve messages from each 4-\/connected neighbor and then update their message based on the retrieved messages and the data cost. Function differs from counterpart overloaded function with same name in that it takes in allocated memory to use in processing. \end{DoxyCompactList}\item 
{\footnotesize template$<$Run\+Data\+\_\+t T, unsigned int DISP\+\_\+\+VALS$>$ }\\\+\_\+\+\_\+global\+\_\+\+\_\+ void \mbox{\hyperlink{namespacebeliefprop__cuda_a27664210a6760cfc437104ae51e806c0}{beliefprop\+\_\+cuda\+::\+Copy\+Msg\+Data\+To\+Next\+Level}} (\mbox{\hyperlink{namespacebeliefprop_a85dcfe709b354b19752ea8ae432f5af5}{beliefprop\+::\+Checkerboard\+Part}} checkerboard\+\_\+part, \mbox{\hyperlink{structbeliefprop_1_1_bp_level_properties}{beliefprop\+::\+Bp\+Level\+Properties}} current\+\_\+bp\+\_\+level, \mbox{\hyperlink{structbeliefprop_1_1_bp_level_properties}{beliefprop\+::\+Bp\+Level\+Properties}} next\+\_\+bp\+\_\+level, T $\ast$message\+\_\+u\+\_\+prev\+\_\+checkerboard\+\_\+0, T $\ast$message\+\_\+d\+\_\+prev\+\_\+checkerboard\+\_\+0, T $\ast$message\+\_\+l\+\_\+prev\+\_\+checkerboard\+\_\+0, T $\ast$message\+\_\+r\+\_\+prev\+\_\+checkerboard\+\_\+0, T $\ast$message\+\_\+u\+\_\+prev\+\_\+checkerboard\+\_\+1, T $\ast$message\+\_\+d\+\_\+prev\+\_\+checkerboard\+\_\+1, T $\ast$message\+\_\+l\+\_\+prev\+\_\+checkerboard\+\_\+1, T $\ast$message\+\_\+r\+\_\+prev\+\_\+checkerboard\+\_\+1, T $\ast$message\+\_\+u\+\_\+checkerboard\+\_\+0, T $\ast$message\+\_\+d\+\_\+checkerboard\+\_\+0, T $\ast$message\+\_\+l\+\_\+checkerboard\+\_\+0, T $\ast$message\+\_\+r\+\_\+checkerboard\+\_\+0, T $\ast$message\+\_\+u\+\_\+checkerboard\+\_\+1, T $\ast$message\+\_\+d\+\_\+checkerboard\+\_\+1, T $\ast$message\+\_\+l\+\_\+checkerboard\+\_\+1, T $\ast$message\+\_\+r\+\_\+checkerboard\+\_\+1, unsigned int bp\+\_\+settings\+\_\+disp\+\_\+vals)
\begin{DoxyCompactList}\small\item\em Kernel to copy the computed BP message values at the current level to the corresponding locations at the \char`\"{}next\char`\"{} level down. The kernel works from the point of view of the pixel at the current level that is being copied to four corresponding pixels in the next level. \end{DoxyCompactList}\item 
{\footnotesize template$<$Run\+Data\+\_\+t T, unsigned int DISP\+\_\+\+VALS$>$ }\\\+\_\+\+\_\+global\+\_\+\+\_\+ void \mbox{\hyperlink{namespacebeliefprop__cuda_afa30b0a712350ea00fbf2c2e12c245ce}{beliefprop\+\_\+cuda\+::\+Retrieve\+Output\+Disparity}} (\mbox{\hyperlink{structbeliefprop_1_1_bp_level_properties}{beliefprop\+::\+Bp\+Level\+Properties}} current\+\_\+bp\+\_\+level, T $\ast$data\+\_\+cost\+\_\+checkerboard\+\_\+0, T $\ast$data\+\_\+cost\+\_\+checkerboard\+\_\+1, T $\ast$message\+\_\+u\+\_\+checkerboard\+\_\+0, T $\ast$message\+\_\+d\+\_\+checkerboard\+\_\+0, T $\ast$message\+\_\+l\+\_\+checkerboard\+\_\+0, T $\ast$message\+\_\+r\+\_\+checkerboard\+\_\+0, T $\ast$message\+\_\+u\+\_\+checkerboard\+\_\+1, T $\ast$message\+\_\+d\+\_\+checkerboard\+\_\+1, T $\ast$message\+\_\+l\+\_\+checkerboard\+\_\+1, T $\ast$message\+\_\+r\+\_\+checkerboard\+\_\+1, float $\ast$disparity\+\_\+between\+\_\+images\+\_\+device, unsigned int bp\+\_\+settings\+\_\+disp\+\_\+vals)
\begin{DoxyCompactList}\small\item\em Retrieve the best disparity estimate from image 1 to image 2 for each pixel in parallel. \end{DoxyCompactList}\end{DoxyCompactItemize}


\doxysubsection{Detailed Description}
This file defines the methods to perform belief propagation for disparity map estimation from stereo images on CUDA. 

\begin{DoxyAuthor}{Author}
Scott Grauer-\/\+Gray
\end{DoxyAuthor}
\begin{DoxyCopyright}{Copyright}
Copyright (c) 2024 
\end{DoxyCopyright}
